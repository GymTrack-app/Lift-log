<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gemini Strength Pro</title>
    <style>
        :root {
            --bg: #09090b; --card: #18181b; --border: #27272a; --accent: #3b82f6; 
            --success: #22c55e; --danger: #ef4444; --text: #fafafa; --muted: #a1a1aa;
        }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, system-ui, sans-serif; margin: 0; padding-bottom: 100px; }
        .screen { display: none; padding: 20px; animation: fadeIn 0.3s; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 16px; margin-bottom: 12px; }
        button { cursor: pointer; border-radius: 12px; font-weight: bold; border: none; padding: 14px; transition: 0.2s; font-size: 1rem; }
        .btn-p { background: var(--accent); color: white; width: 100%; }
        .btn-s { background: var(--border); color: var(--text); width: 100%; margin-top: 10px; }
        .nav { position: fixed; bottom: 0; width: 100%; background: rgba(9,9,11,0.9); backdrop-filter: blur(10px); border-top: 1px solid var(--border); display: flex; padding: 15px 0; z-index: 100; }
        .nav-i { flex: 1; text-align: center; color: var(--muted); font-size: 12px; cursor: pointer; }
        .nav-i.active { color: var(--accent); font-weight: bold; }
        input { background: #000; border: 1px solid var(--border); color: #fff; padding: 12px; border-radius: 10px; width: 100%; box-sizing: border-box; margin: 8px 0; font-size: 1rem; }
        h1 { font-size: 1.8rem; margin-bottom: 20px; }
        .plateau { border: 1px solid var(--danger); background: rgba(239, 68, 68, 0.1); color: var(--danger); font-size: 0.8rem; padding: 10px; border-radius: 10px; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div id="today" class="screen active"><h1>Today</h1><div id="plateauBox"></div><div id="todayBox"></div><button class="btn-p" id="startBtn" style="display:none" onclick="app.startWorkout()">Start Workout</button></div>
    <div id="stats" class="screen"><h1>Stats</h1><div id="statsBox"></div></div>
    <div id="settings" class="screen"><h1>Settings</h1><div id="setBox"></div></div>
    <div id="logger" class="screen"><h1>Logging...</h1><div id="logBox"></div><button class="btn-p" onclick="app.finishWorkout()">Finish Workout</button></div>

    <nav class="nav">
        <div class="nav-i active" id="n-today" onclick="app.nav('today')">‚ö° Today</div>
        <div class="nav-i" id="n-stats" onclick="app.nav('stats')">üìà Stats</div>
        <div class="nav-i" id="n-settings" onclick="app.nav('settings')">‚öôÔ∏è Settings</div>
    </nav>
    <script>
    const app = {
        state: JSON.parse(localStorage.getItem('gem_pro_v4')) || {
            split: [], exercises: {}, sessions: [], activeTab: 'today'
        },
        save() { 
            localStorage.setItem('gem_pro_v4', JSON.stringify(this.state)); 
            this.render(); 
        },
        nav(t) { 
            this.state.activeTab = t;
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-i').forEach(n => n.classList.remove('active'));
            document.getElementById(t).classList.add('active');
            document.getElementById('n-' + (t === 'logger' ? 'today' : t)).classList.add('active');
            this.render();
        },
        calc1RM(w, r) { return w * (1 + (r / 30)); }
    };
    app.renderToday = function() {
        const box = document.getElementById('todayBox');
        const pBox = document.getElementById('plateauBox');
        const dow = new Date().getDay();
        const plan = this.state.split.find(s => s.day == dow);
        
        pBox.innerHTML = '';
        if (!plan) {
            box.innerHTML = '<div class="card"><p class="muted">Rest Day. Recovery is progress!</p></div>';
            document.getElementById('startBtn').style.display = 'none';
            return;
        }
        
        document.getElementById('startBtn').style.display = 'block';
        box.innerHTML = `<div class="card"><h3>${plan.name}</h3><p class="muted">${plan.list.length} Exercises scheduled</p></div>`;
        
        // Plateau logic: Check if 1RM has improved in last 3 sessions
        plan.list.forEach(exId => {
            const history = this.state.sessions.filter(s => s.results[exId]).slice(-3);
            if(history.length >= 3 && history[0].results[exId] <= history[2].results[exId]) {
                pBox.innerHTML += `<div class="plateau">‚ö†Ô∏è Plateau on ${this.state.exercises[exId].name}: No progress in 3 sessions.</div>`;
            }
        });
    };

    app.startWorkout = function() { this.nav('logger'); };

    app.renderLogger = function() {
        const box = document.getElementById('logBox');
        const dow = new Date().getDay();
        const plan = this.state.split.find(s => s.day == dow);
        box.innerHTML = plan.list.map(id => `
            <div class="card">
                <strong>${this.state.exercises[id].name}</strong>
                <input type="number" id="w-${id}" placeholder="Weight">
                <input type="number" id="r-${id}" placeholder="Reps">
            </div>
        `).join('');
    };
    app.finishWorkout = function() {
        const dow = new Date().getDay();
        const plan = this.state.split.find(s => s.day == dow);
        const session = { date: new Date().toLocaleDateString(), results: {} };
        
        plan.list.forEach(id => {
            const w = parseFloat(document.getElementById(`w-${id}`).value) || 0;
            const r = parseFloat(document.getElementById(`r-${id}`).value) || 0;
            session.results[id] = this.calc1RM(w, r);
        });
        
        this.state.sessions.push(session);
        this.save();
        alert("Workout Saved!");
        this.nav('today');
    };

    app.renderSettings = function() {
        const box = document.getElementById('setBox');
        box.innerHTML = `<button class="btn-p" onclick="app.addDay()">+ Add Workout Day</button>`;
        this.state.split.forEach((s, i) => {
            box.innerHTML += `<div class="card"><strong>${s.name}</strong> (Day ${s.day})<button class="btn-s" onclick="app.addEx(${i})">+ Add Exercise</button></div>`;
        });
    };

    app.addDay = function() {
        const name = prompt("Day Name (e.g. Push)?");
        const day = prompt("Day # (0=Sun, 1=Mon)?");
        if(name) { this.state.split.push({ name, day, list: [] }); this.save(); }
    };

    app.addEx = function(i) {
        const name = prompt("Exercise Name?");
        if(name) {
            const id = 'ex_' + Date.now();
            this.state.exercises[id] = { name };
            this.state.split[i].list.push(id);
            this.save();
        }
    };

    app.render = function() {
        if (this.state.activeTab === 'today') this.renderToday();
        if (this.state.activeTab === 'logger') this.renderLogger();
        if (this.state.activeTab === 'settings') this.renderSettings();
    };

    app.render();
    </script>
</body>
</html>
